# Predict_fire_forest - 머신러닝

## 1. 프로젝트 개요
### 팀명: 예측 "불" 가능
### 문제 정의
- 산불은 빠르게 확산되며 막대한 피해를 초래할 수 있음.
- 머신러닝 모델을 활용하여 산불 발생 가능성을 예측하고, 이를 통해 재해 예방 및 대응 시스템을 개선하는 것이 목표.

### 핵심 해결 과제
1. 산불 발생 여부를 예측할 수 있는 머신러닝 모델을 구축할 수 있는가?
2. 데이터 불균형 문제를 해결하고 성능을 최적화할 수 있는가?
3. 다양한 모델을 비교하여 최적의 모델을 선정할 수 있는가?

---

## 2. 팀원 및 역할 분담
- **이승재**: PPT 제작 및 솔루션 기획  
- **박형빈**: 데이터 수집 및 정제  
- **정재식**: 모델 개발 및 평가 진행  

---

## 3. 본인이 수행한 작업 및 문제 해결 과정
### (1) 데이터 전처리 및 피처 엔지니어링
#### 목표: 학습에 적합한 형태로 데이터를 가공하고, 데이터 불균형 문제 해결
#### 해결 방법
- 전처리된 데이터를 기반으로 피처 엔지니어링 진행
- 데이터 불균형 문제 해결  
  - 산불 발생 데이터보다 미발생 데이터가 많아 클래스 불균형 발생  
  - 기존에는 **SMOTE**(Synthetic Minority Over-sampling Technique)를 사용하여 오버샘플링만 진행  
  - **언더샘플링 기법을 추가로 도입하여 불균형 문제를 완화**
- 수치형 데이터 정규화  
  - **StandardScaler**를 활용하여 데이터의 스케일을 맞추어 모델 학습 성능 향상  

**결과:**  
- 데이터 불균형이 완화되었으며, 학습에 적합한 형태로 가공 완료  

---

### (2) 머신러닝 모델 학습 및 평가
#### 목표: 최적의 성능을 보이는 모델 선정 및 성능 개선
#### 해결 방법
- 전국 8도를 기준으로 다양한 머신러닝 모델 학습 및 평가  
  - 사용한 모델
    - **LogisticRegression**
    - **XGBClassifier**
    - **LGBMClassifier**
    - **RandomForestClassifier**
- 성능 평가 지표 활용  
  - **confusion_matrix**
  - **roc_auc_score**
  - **accuracy_score**
- 모델 성능 비교  
  - 기존에는 **roc_auc_score**를 기준으로 모델을 비교하여 가장 높은 성능을 보이는 모델을 선정  
  - 하지만 **roc_auc_score는 클래스 불균형 문제에서 적절하지 않을 수 있음**  

**결과:**  
- 전국(단일 데이터) 기준으로 4가지 모델을 학습하여 **최적의 성능을 보이는 모델을 선정**  
- 향후 **Precision-Recall AUC (PR-AUC)를 추가적으로 평가 지표로 고려하여 모델을 개선할 필요가 있음**  

---

### (3) 하이퍼파라미터 튜닝 및 모델 최적화
#### 목표: 최적의 모델을 기반으로 성능을 더욱 향상
#### 문제 발생 및 해결 방법
- 랜덤 서치를 통해 최적의 파라미터를 찾은 후, 그리드 서치를 진행하였으나 속도가 너무 오래 걸려 작업이 힘들어지는 문제 발생  
- 해결 방법
  - 기존에는 **랜덤 서치 후 그리드 서치를 추가로 진행**  
  - **파라미터 수를 줄이고 그리드 서치만을 진행하여 학습 속도를 개선**  

- 모델 앙상블 적용  
  - 단일 모델의 성능을 최적화하는 것만으로는 한계가 존재  
  - 4가지 모델을 **StackingClassifier**를 활용하여 여러 모델의 예측 결과를 종합  
  - 최종 모델(**final_estimator**)에 반영하여 성능을 향상  

**결과:**  
- 기존 단일 모델보다 **StackingClassifier를 활용한 모델이 더 높은 성능을 보임**  
- 하이퍼파라미터 튜닝 속도를 개선하여 모델 개발 시간을 단축  

---

## 4. 이슈 발생 및 해결 경험
### (1) 데이터 불균형 문제
**문제**: 산불 발생 데이터보다 미발생 데이터가 지나치게 많아 모델이 편향적으로 학습됨  
**해결 방법**: SMOTE를 사용한 오버샘플링뿐만 아니라 **언더샘플링 기법도 추가하여 데이터 균형 조정**  

### (2) 하이퍼파라미터 튜닝 속도 문제
**문제**: 랜덤 서치 후 그리드 서치를 진행하는 방식이 비효율적으로 시간이 오래 걸림  
**해결 방법**:  
- **랜덤 서치 없이 그리드 서치만 진행하여 속도를 개선**  
- 사용하지 않는 파라미터를 제거하여 탐색 공간을 줄임  

### (3) 모델 성능 향상  
**문제**: 개별 모델 성능이 한계를 보이며, 특정 모델이 특정 조건에서만 우수한 결과를 보임  
**해결 방법**:  
- **StackingClassifier를 활용하여 여러 모델의 예측 결과를 종합**  
- 단일 모델보다 안정적인 성능을 보이는 최적 모델 개발  

---

## 5. 프로젝트 발전을 위한 개선 방안 및 원인 분석
### (1) Feature 설명력 부족
- 현재 사용한 Feature만으로는 예측 성능에 한계가 있음
- 추가적으로 학습을 고도화하기 위해 **다양한 Feature 추가 필요**
  - **지형 및 토지 이용 관련 Feature**: 경사도, 고도, 토양 수분량 등  
  - **인간 활동 관련 Feature**: 쓰레기 및 불법 소각 데이터, 캠핑장 및 등산로 분포  

### (2) 평가 지표의 개선 필요
- 기존에는 **ROC-AUC를 주요 평가 지표로 활용**  
- 그러나 산불 예측은 **소수 클래스(불균형 데이터) 문제이므로 Precision-Recall AUC (PR-AUC)를 평가하는 것이 바람직할 것으로 판단됨**  
- **향후 PR-AUC를 활용하여 모델 개선을 고려할 필요가 있음**  

---

## 6. 사용한 기술 및 문제 해결 과정
| 기술 | 사용 이유 및 문제 해결 |
|------|--------------------|
| **Python** | 데이터 분석 및 머신러닝 모델 구축 |
| **Pandas** | 데이터 로드 및 전처리 |
| **Jupyter Notebook** | 분석 과정 정리 및 실행 |
| **SMOTE + 언더샘플링** | 데이터 불균형 문제 해결 |
| **StandardScaler** | 수치형 데이터 정규화 |
| **Scikit-learn** | 머신러닝 모델 학습 및 평가 |
| **XGBoost, LightGBM** | 최적의 성능을 위한 모델 선택 |
| **StackingClassifier** | 모델 앙상블을 통한 성능 향상 |
| **Matplotlib** | 모델 성능 시각화 |

---

## 7. 프로젝트 결과 및 기대 효과
- 산불 발생 가능성을 예측하는 머신러닝 모델 구축
- 데이터 불균형 문제를 해결하여 신뢰성 높은 예측 모델 개발
- 재해 예방 및 대응 시스템 개선에 기여할 수 있는 모델 제안
